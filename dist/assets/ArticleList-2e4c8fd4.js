import{r as c,j as e}from"./react-e18f0737.js";import{u as D,a as J}from"./index-f2cbb2ea.js";import{M as u}from"./materialize-css-70fed0bb.js";import{g as w}from"./getCookie-1314a3b0.js";import{a as K}from"./axios-47b9d439.js";import{u as q}from"./react-router-e59ff506.js";import"./react-dom-ef54bb36.js";import"./scheduler-765c72db.js";import"./react-router-dom-dd71e3b7.js";import"./@remix-run-3dbd2488.js";const G=s=>{const d=async()=>{u.toast({html:"Article Saved!"});const i=localStorage.getItem("userId"),m=w("token");try{const l=await K.post(`https://newsappupdated.onrender.com/articles/${i}`,{articleName:s.title,articleLink:s.url,articleText:s.content,articleImage:s.urlToImage,articleSource:s.source},{headers:{Authorization:`${m}`,"Content-Type":"application/json"}});console.log(l);const n=[...JSON.parse(localStorage.getItem("cachedArticles"))||[],{articleName:s.title,articleLink:s.url,articleText:s.content,articleImage:s.urlToImage,articleSource:s.source}];localStorage.setItem("cachedArticles",JSON.stringify(n))}catch(l){console.error("Error saving article:",l)}};return c.useEffect(()=>{u.AutoInit()},[]),e.jsx(e.Fragment,{children:e.jsx("div",{className:"col s12 m6",children:e.jsxs("div",{className:"card purple white-text z-depth-3",style:{height:"380px"},children:[e.jsxs("div",{className:"card-image",children:[e.jsx("img",{src:s.urlToImage,style:{height:"180px"},alt:s.title}),e.jsx("span",{className:"card-title",children:s.title})]}),e.jsxs("div",{className:"card-content",style:{padding:"10px"},children:[e.jsx("p",{children:s.content}),"From ",s.source]}),e.jsxs("div",{className:"card-action",children:[e.jsx("a",{onClick:d,children:"Save Article"}),e.jsx("a",{href:s.url,children:"Read More"})]})]})})})},se=()=>{const{userName:s}=D(),{updateAuthState:d}=J(),i=q(),[m,l]=c.useState(!1),[x,n]=c.useState(!1),[r,o]=c.useState(1),[h]=c.useState(6),[p,k]=c.useState([]),[g,b]=c.useState(""),[j,C]=c.useState("relevancy"),[f,A]=c.useState(""),[v,I]=c.useState(""),y=r*h,T=y-h,E=p.slice(T,y),N=Math.ceil(p.length/h),F=Array.from({length:N},(t,a)=>a+1),z=async()=>{n(!0);const t=w("token");try{const a=await fetch(`https://newsappupdated.onrender.com/sortBy:${j}/from:${f}/to:${v}/querry:${g}`,{method:"GET",headers:{Authorization:t,"Content-Type":"application/json"}});if(!a.ok)throw new Error("Network response was not ok");const S=await a.json();console.log(S.articles),k(S.articles),n(!1),l(!0)}catch(a){console.error("There was a problem with your fetch operation:",a.message),n(!1)}},L=()=>{localStorage.removeItem("token"),localStorage.removeItem("cachedArticles"),d(!1),i("/")},P=t=>b(t.target.value),R=t=>C(t.target.value),$=t=>A(t.target.value),B=t=>I(t.target.value),O=()=>{r!==1&&o(r-1)},M=()=>{r!==N&&o(r+1)},_=t=>{t.preventDefault(),o(1),z()};return c.useEffect(()=>{u.AutoInit();const t=document.createElement("script");t.src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js",t.async=!0,document.body.appendChild(t);const a=document.createElement("link");return a.href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css",a.rel="stylesheet",document.head.appendChild(a),()=>{document.head.removeChild(a),document.body.removeChild(t)}},[]),e.jsxs("div",{className:"articlelist-section",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col s9 m9",children:e.jsxs("p",{style:{fontFamily:"monospace",fontSize:"20px",padding:"10px"},children:["ðŸ‘‹ Welcome back, ",s,"!"]})}),e.jsxs("div",{className:"col s3 m3",children:[e.jsx("button",{className:"btn waves-effect waves-light left purple",type:"submit",name:"action",style:{marginTop:"10px"},onClick:L,children:"Log out"}),e.jsx("button",{className:"btn waves-effect waves-light left purple",type:"submit",name:"action",style:{marginTop:"10px"},onClick:()=>i("/savedarticles"),children:"Saved Articles"})]})]}),e.jsx("h3",{className:"center purple-text darken-3",style:{fontFamily:"monospace"},children:"Find your Articles"}),e.jsx("div",{className:"container",children:e.jsx("div",{className:"row center z-depth-3",style:{border:"7px solid #8e24aa",padding:"10px",borderRadius:"20px"},children:e.jsxs("form",{onSubmit:_,children:[e.jsxs("div",{className:"input-field col s6",children:[e.jsx("input",{id:"keyword",type:"text",className:"validate",value:g,onChange:P}),e.jsx("label",{htmlFor:"keyword",children:"Enter any keyword"})]}),e.jsxs("div",{className:"input-field col s6",children:[e.jsxs("select",{value:j,onChange:R,children:[e.jsx("option",{value:"relevancy",children:"Relevant"}),e.jsx("option",{value:"popularity",children:"Popular"}),e.jsx("option",{value:"publishedAt",children:"Latest"})]}),e.jsx("label",{children:"Sort By"})]}),e.jsx("div",{className:"input-field col s6",children:e.jsx("input",{className:"datepicker",placeholder:"From",value:f,onChange:$})}),e.jsx("div",{className:"input-field col s6",children:e.jsx("input",{className:"datepicker",placeholder:"To",value:v,onChange:B})}),e.jsxs("button",{className:"btn waves-effect waves-light purple",type:"submit",name:"action",children:["Submit",e.jsx("i",{className:"material-icons right",children:"send"})]})]})})}),x&&e.jsx("div",{className:"progress",children:e.jsx("div",{className:"indeterminate"})}),e.jsxs("div",{className:"container row",children:[e.jsx("div",{className:"col s12",children:E.filter(t=>t.urlToImage).map((t,a)=>e.jsx(G,{title:t.title,url:t.url,content:t.content,urlToImage:t.urlToImage,source:t.source.name},a))}),e.jsx("div",{className:"col 12",children:m&&e.jsxs("ul",{className:"pagination",children:[e.jsx("li",{className:"waves-effect",children:e.jsx("a",{href:"#!",onClick:O,children:e.jsx("i",{className:"material-icons",children:"chevron_left"})})}),F.map(t=>e.jsx("li",{className:`waves-effect ${r===t?"active":""}`,children:e.jsx("a",{onClick:()=>o(t),className:"page-link",href:"#",children:t})},t)),e.jsx("li",{className:"waves-effect",children:e.jsx("a",{href:"#!",onClick:M,children:e.jsx("i",{className:"material-icons",children:"chevron_right"})})})]})})]})]})};export{se as default};
